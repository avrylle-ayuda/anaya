<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Home - ANAYA</title>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Nunito', sans-serif;
      margin: 0;
      padding: 0;
      background: #f4f9f4;
    }

    /* Header */
    .header {
      position: relative;
      background: linear-gradient(135deg, #64b651, #a5cd41);
      padding: 0px;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      color: white;
      min-height: 300px;
    }

    /* Hamburger Button */
    .menu-container {
      position: absolute;
      top: 20px;
      left: 20px;
    }

    .menu-button {
      font-size: 28px;
      background: none;
      border: none;
      color: white;
      cursor: pointer;
    }

    /* Dropdown Menu */
    .dropdown {
      position: absolute;
      top: 40px;
      left: 0;
      background: white;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      border-radius: 6px;
      overflow: hidden;
      z-index: 10;
    }

    .dropdown button {
      width: 100%;
      padding: 10px 20px;
      border: none;
      background: white;
      cursor: pointer;
      font-family: 'Nunito', sans-serif;
      text-align: left;
    }

    .dropdown button:hover {
      background: #f0f0f0;
    }

    /* Centered logo */
    .header-center {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      text-align: center;
    }

    .header-center img {
      height: 130px;
    }

    /* Avatar */
    .user-icon {
      height: 36px;
      width: 36px;
      object-fit: contain;
    }

    /* Greeting */
    #greeting {
      position: absolute;
      bottom: -25px;
      left: 20px;
      font-size: 70px;
      font-weight: 700;
    }

    /* Search Bar - ENHANCED */
    .search-bar {
      margin: 20px auto;
      max-width: 600px;
      display: flex;
      align-items: center;
      background: white;
      border-radius: 25px;
      padding: 8px 15px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      transition: box-shadow 0.3s ease;
    }

    .search-bar:focus-within {
      box-shadow: 0 4px 12px rgba(100, 182, 81, 0.3);
    }

    .search-bar input {
      border: none;
      flex: 1;
      padding: 12px 15px;
      font-size: 16px;
      outline: none;
      font-family: 'Nunito', sans-serif;
      background: transparent;
    }

    .search-bar input::placeholder {
      color: #999;
      font-style: italic;
    }

    .search-bar button {
      background: none;
      border: none;
      cursor: pointer;
      padding: 8px;
      transition: transform 0.2s ease;
    }

    .search-bar button:hover {
      transform: scale(1.1);
    }

    .search-bar button img {
      width: 20px;
      height: 20px;
      filter: grayscale(0.5);
      transition: filter 0.2s ease;
    }

    .search-bar button:hover img {
      filter: none;
    }

    /* Search Results Info */
    .search-info {
      max-width: 1000px;
      margin: 10px auto;
      padding: 0 20px;
      font-size: 14px;
      color: #666;
      text-align: center;
    }

    /* Card Grid */
    .card-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      max-width: 1000px;
      margin: 30px auto;
      padding: 0 20px;
      transition: opacity 0.3s ease;
    }

    .card {
      padding: 20px;
      border-radius: 16px;
      color: white;
      font-weight: 600;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      cursor: pointer;
      transition: all 0.3s ease;
      opacity: 1;
      transform: translateY(0);
    }

    .card.hidden {
      display: none;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.2);
    }

    .green-card {
      background: linear-gradient(135deg, #64b651, #a5cd41);
    }
    .pink-card {
      background: linear-gradient(135deg, #ed1a6d, #f05f99);
    }

    .card h3 {
      margin: 0 0 8px;
      font-size: 18px;
    }
    .card p {
      margin: 0;
      font-size: 14px;
      font-weight: 400;
    }

    /* No Results Message */
    .no-results {
      grid-column: 1 / -1;
      text-align: center;
      padding: 40px;
      color: #666;
      font-size: 18px;
      display: none;
    }

    .no-results.show {
      display: block;
    }

    .no-results img {
      width: 80px;
      height: 80px;
      margin-bottom: 15px;
      opacity: 0.5;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <div class="header">
    <!-- Hamburger + Dropdown -->
    <div class="menu-container">
      <button class="menu-button" onclick="toggleMenu()">☰</button>
      <div class="dropdown" id="dropdownMenu">
        <button id="logoutButton">Log Out</button>
      </div>
    </div>

    <!-- Centered Logo -->
    <div class="header-center">
      <img src="/static/ANAYA_logo.png.png" alt="ANAYA Logo" />
    </div>

    <!-- Avatar -->
    <div style="position: absolute; top: 20px; right: 20px;">
      <img src="/static/847969.png" class="user-icon" alt="User" />
    </div>

    <!-- Greeting -->
    <h2 id="greeting">Hello, User!</h2>
  </div>

  <!-- Search Bar - INTERACTABLE -->
  <div class="search-bar">
    <input type="text" id="searchInput" placeholder="Search for Disease Prediction, Climate, Health..." />
    <button onclick="clearSearch()">
      <img src="/static/622669.png" alt="Search Icon" id="searchIcon">
    </button>
  </div>

  <!-- Search Results Info -->
  <div class="search-info" id="searchInfo">
    <span id="resultsCount">4</span> results found
  </div>

  <!-- Cards -->
  <div class="card-grid" id="cardGrid">
    <div class="card green-card" data-title="Disease Prediction" data-desc="Rice disease forecast based on climate variables">
      <h3>Disease Prediction</h3>
      <p>Rice disease forecast based on climate variables</p>
    </div>
    <div class="card pink-card" data-title="Seasonal Climate" data-desc="Historical average climate charts">
      <h3>Seasonal Climate</h3>
      <p>Historical average climate charts</p>
    </div>
    <div class="card pink-card" data-title="Crop Health & Tips" data-desc="Disease guide and management tips">
      <h3>Crop Health & Tips</h3>
      <p>Disease guide and management tips</p>
    </div>
    <div class="card green-card" data-title="Knowledge Base" data-desc="Rice farming learning content">
      <h3>Knowledge Base</h3>
      <p>Rice farming learning content</p>
    </div>

    <!-- No Results Message -->
    <div class="no-results" id="noResults">
      <img src="/static/709612.png" alt="No Results">
      <div>No results found for "<span id="noResultsQuery"></span>"</div>
      <div style="font-size: 14px; margin-top: 5px;">Try searching for: Disease, Climate, Health, Knowledge</div>
    </div>
  </div>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>

  <script>
    // ✅ Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyBeBzi3S6aMVhRje2oYjSidAgeAhWnQSYs",
      authDomain: "anaya-trial-25626.firebaseapp.com",
      projectId: "anaya-trial-25626",
      storageBucket: "anaya-trial-25626.firebasestorage.app",
      messagingSenderId: "318384671749",
      appId: "1:318384671749:web:3e99da15a3d3836251606c",
      measurementId: "G-QL0RDLTT87"
    };

    // ✅ Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    // ✅ Logout function
    function logout() {
      console.log("Logout called");
      auth.signOut().then(() => {
        window.location.href = "signin.html";
      });
    }

    // ✅ Greet user
    auth.onAuthStateChanged((user) => {
      if (user) {
        const displayName = user.displayName || user.email;
        let firstName = displayName.split(" ")[0];
        document.getElementById("greeting").innerText = `Hello, ${firstName}!`;
      } else {
        window.location.href = "signin.html";
      }
    });

    // ✅ Dropdown toggle
    function toggleMenu() {
      const menu = document.getElementById('dropdownMenu');
      menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
    }

    // ✅ Close dropdown when clicking outside
    window.addEventListener('click', (event) => {
      const menu = document.getElementById('dropdownMenu');
      const isMenuButton = event.target.closest('.menu-button');
      const isInsideMenu = event.target.closest('#dropdownMenu');

      if (!isMenuButton && !isInsideMenu) {
        menu.style.display = 'none';
      }
    });

    // ✅ Attach the logout function to the button
    document.addEventListener("DOMContentLoaded", () => {
      const logoutBtn = document.getElementById("logoutButton");
      if (logoutBtn) {
        logoutBtn.addEventListener("click", logout);
      }

      // ✅ SEARCH FUNCTIONALITY
      const searchInput = document.getElementById('searchInput');
      const cardGrid = document.getElementById('cardGrid');
      const cards = document.querySelectorAll('.card:not(.no-results)');
      const searchInfo = document.getElementById('searchInfo');
      const resultsCount = document.getElementById('resultsCount');
      const noResults = document.getElementById('noResults');
      const noResultsQuery = document.getElementById('noResultsQuery');

      searchInput.addEventListener('input', performSearch);
      searchInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          performSearch();
        }
      });

      function performSearch() {
        const query = searchInput.value.trim().toLowerCase();
        let visibleCount = 0;

        cards.forEach(card => {
          const title = card.getAttribute('data-title').toLowerCase();
          const desc = card.getAttribute('data-desc').toLowerCase();
          const isVisible = title.includes(query) || desc.includes(query) || query === '';

          card.classList.toggle('hidden', !isVisible);
          if (isVisible) visibleCount++;
        });

        // Update search info
        if (query === '') {
          searchInfo.style.display = 'none';
          resultsCount.textContent = cards.length;
        } else {
          searchInfo.style.display = 'block';
          resultsCount.textContent = visibleCount;
        }

        // Show/hide no results message
        if (visibleCount === 0 && query !== '') {
          noResultsQuery.textContent = query;
          noResults.classList.add('show');
        } else {
          noResults.classList.remove('show');
        }

        // Add smooth animation
        cardGrid.style.opacity = '0.5';
        setTimeout(() => {
          cardGrid.style.opacity = '1';
        }, 150);
      }

      function clearSearch() {
        searchInput.value = '';
        performSearch();
        searchInput.focus();
      }

      // ✅ Card click handlers (preserve original functionality)
      document.querySelector('.card[data-title="Disease Prediction"]').onclick = () => location.href='prediction.html';
      document.querySelector('.card[data-title="Seasonal Climate"]').onclick = () => location.href='climate.html';
      document.querySelector('.card[data-title="Crop Health & Tips"]').onclick = () => location.href='health.html';
      document.querySelector('.card[data-title="Knowledge Base"]').onclick = () => location.href='knowledge.html';
    });
  </script>
</body>
</html>